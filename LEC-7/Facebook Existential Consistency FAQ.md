## Facebook Existential Consistency FAQ

 
问：什么是本地一致性？
 
A：一次可以检查一个对象的本地一致性模型，
没有明确考虑操作之间的关系
不同的对象 线性化是本地可检查的，因为它
保证关于挂钟时间允许检查器轻松发现
读取返回失效值的情况（即从之前）
最近写入对象的实时时间）。其他机型减弱
实时约束与保证程序顺序的保证
（例如，如果一个线程读取y，则写入x，...），这不能
通过查看只是x，而不是y。论文谈到
本地模型由于其原则一致性分析使用了跟踪
的操作只是一小部分对象，因此不能
一般来看不同操作之间的关系
对象。

问：本地/非本地与弱/强之间有关系吗？

答：我怀疑，一般而言，本地模式比非本地模式弱
楷模。非本地模式更具有强制性的范围
约束比本地模型。

线性化是否真的算作本地模型还不清楚，
因为它使用时间限制一套法定情景和时间
是一个全球现象。
 
问：什么是因果一致性？
 
A：假设客户端C1读取对象o1并看到值v1，然后
用值v2写入对象o2。因果一致性要求任何
客户端C2读取o2并看到v2，然后读取o1，必须看到值
v1 for o1。不太正式地，如果客户看到一个写，它也必须看到
所有的写作都可能有助于书面价值。
 
因果一致性的一点是（像往常一样）试图确保
并发程序的行为明智而不需要太多
通讯。例如，假设x和y是共享变量
从零开始。我们只有三个线程：
 
T1：
  y = 100
 
T2：
  x = y + 1
 
T3：
  打印x，y
 
因果一致性允许T3打印0，0; 1，0; 101，100; ＆C。但它
不允许T3打印101，0  - 因为如果T3看到T2的写，它
也需要看到T2看到的所有写入（即T1的写）。

在更高层次上，可以使用因果一致性来避免异常
就像在回复消息之前出现的后续消息
至。

问：什么是TAO？

答：TAO是一个地理位置分布的数据存储
高效地访问Facebook的社交图。看一下
https://www.facebook.com/notes/facebook-engineering/tao-the-power-of-the-graph/10151525983993920/
和
https://www.usenix.org/conference/atc13/technical-sessions/presentation/bronson

问：为什么将读取节点合并到写入节点中是有意义的
线性化检查器在图2 / 3.2节中？

A：将图形视为只包含写入，带有定向边
表达两种秩序。应该有一个从W'到W'的边缘
如果W'在W'开始之前完成（在挂钟时间）。在那里
应该是从W'到W'的边缘，如果读取不与任何一个并发
观察到W'完成后W“写的值。所以在图4中
建议您关注（c）：W1-> W2边缘表示W1的事实
W2开始前完成，W2-> W1边表示事实
W2完成后读取W1的值。在图5（c）中，因为
W1和W2是并行的，只有第二种的边缘：
W1表示在W1完成后R2看到W2的值，
W2-> W1表示在W2完成后，R1看到W1的值。

问：为什么他们对密码进行例外处理并存储在其中
线性化存储？
 
A：如果用户更改密码，最好是使用旧密码
立即停止工作。因为用户可能已经改变了
由于担心别人可能已经学会了密码
密码并积极使用它。

问：对于像Facebook这样的系统，什么时候有用
强一致性

答：一个学派认为，最终的设计空间
一致性和完整的ACID交易不是很有用，例如
线性化和因果一致性是不值得的。但不是
大家都相信。

强烈的一致性有两个好处：它使它更容易
写正确的程序，它可以提高新鲜度
人们看到的信息的可懂度。

如果软件可以依赖线性化，那么可以小心使用
写入的顺序来实现正确性。一个例子是PNUTS
纸张从ACL中删除用户U1并插入新照片。
在线性化之前，等待ACL写入完成
发出照片插件足以确保U1看不到
新照片。最终的一致性使得更难; 也许一个会
必须将ACL和照片列表放在同一条记录中，然后进行更新
在单写。

人类可以欣赏强烈的一致性，因为它减少了量
他们看到的陈旧或延迟的数据。如果数据可能很重要
是股票报价或拍卖出价，或来自其他用户的消息。延误
或者几毫秒的平常通常可以，但用户可能会感到烦恼
以秒或分钟为单位。

强大的一致性可以使数据呈现给人类更直观
避免异常排序。例如，最终的一致性可能
导致消息传递系统显示之前的后续发布
原始帖子出现，而强烈的一致性可能会阻止。

更强的一致性的劣势当然是这样的
昂贵的提供。也许是制作FB系统最简单的方法
线性化是为每次写入不返回，直到所有缓存
数据副本将被无效或更新。这将会
写得很慢

问：我们可以从纸上看到更多的经验教训
只有少数违反线性化的行为？

A：可以肯定的是，Facebook的用户不会感觉到很多
存储系统提供更强一致性的区别。
但是还不清楚这一观察是否普遍化。

很容易想像异常情况会更多的情况
共同。如果有一些经常阅读的流行记录
并由所有地区的许多用户撰写，分数高得多
读取可能已返回过期数据。原因是新的价值观
并且无效在后台传播（也许缓慢）
缓存副本。

Facebook也有可能需要一些努力
程序员编写与最终表现良好的软件
一致性。如果存储系统反而保证强大
一致性，也许一些软件会更容易
写。也许弱的一致性使得Facebook的程序员避免
使用存储系统进行某些任务。该文件说这是真的
密码。

问：为什么论文谈论phi一致性？

答：phi一致性不符合任何其他定义
一致性。而是检查所有缓存是否相同
给定键的值。这是一致的，因为
如果没有写入，缓存应该有相同的
值。如果有积极的写作，phi可能会低于100％
这并不一定意味着存在一致性
违反。作者使用phi-consistency作为可能的提示
存储系统故障 - 如果键的数量不同
不同缓存中的值会上升，有些可能会被破坏。
